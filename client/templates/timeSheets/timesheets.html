<template name="addTimesheet">
    <style>
        #timesheet_description{
            height: 6rem;
            resize: none;
        }
        #timer-lists h5{
            margin: 0;
            padding: 0.5rem 0.9rem;
        }
        #timer-lists .card-panel{
            height: 250px;
            overflow: auto;
            padding: 0;
        }
        #timer-lists .collection{
            margin: 0;
        }
        .state-change{
            padding: 0 10px;
            margin-right: 10px;
        }
    </style>
    {{> navigation }}
    <div class="container add-project">
        <div class="row">
            <div class="col s12">
                <h4 class="teal form-header">Add a Timesheet</h4>
                {{# autoForm id="insertTimesheetForm" class="card-panel" doc=this type="normal" resetOnSuccess="true" schema="timesheetSchema" }}
                    <div class="row">
                        <div class="input-field col s12">
                            {{> afQuickField name='caseId' id="timesheet_case" label=false}}
                            <label for="caseId" class="active">Matter</label>
                        </div>
                    </div>

                    <div class="row">
                        <div class="input-field col s12">
                            {{> afFieldInput type="selectize" isReactiveOptions="true" formid="insertTimesheetForm" name='taskId' options=tasks id="timesheet_task" placeholder="Select a task"}}
                            <label for="taskId" class="active">Task</label>
                        </div>
                    </div>

                    <div class="row">
                        <div class="input-field col s12">
                            {{> afQuickField name='description' label=false id="timesheet_description"}}
                            <label class="active">Description</label>
                        </div>
                    </div>

                    <div class="row">
                        <div class="input-field col s12">
                            {{> afQuickField name='type' options='allowed' label=false}}
                            <label for="type" class="active">Type</label>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col s12">
                            <button class="waves-effect waves-light btn" type="submit" id="create-timer">Create</button>
                            <a class="waves-effect waves-teal btn-flat" href="/projects" style="position: absolute;">Cancel</a>
                        </div>
                    </div>
                {{/autoForm}}
            </div>
        </div>
    </div>
</template>

<template name="runningTimesheetRow">
    <div class="valign-wrapper">
        <div class="col s2">
            <a class="btn-flat waves-effect state-change">
                {{#if isRunning}}
                    <i class="mdi-av-pause"></i>
                {{else}}
                    <i class="mdi-av-play-arrow"></i>
                {{/if}}
            </a>
        </div>
        <div class="col s2 truncate">
            {{case}}
        </div>
        <div class="col s6 truncate">
            {{task}}
        </div>
        <div class="col s2">
            {{duration}}
        </div>
    </div>
</template>

<template name="timesheets">
    <style>
        #add-timesheets{
            right: 24px;
            bottom: 45px;
            position: fixed;
        }
        #timer-lists h5{
            padding: 0.5rem 0.9rem;
        }
        #timer-lists .card-panel{
            min-height: 410px;
            padding: 0;
        }
        #timer-lists .collection{
            margin: 0;
        }
        .state-change{
            padding: 0 10px;
            margin-right: 10px;
        }

    </style>
    {{> navigation}}
    <div class="container-fluid">
        <div class="row" id="timer-lists">
            <div class="col s12 m12 l6">
                <h5 class="teal white-text">Running Timers</h5>
                <div class="card-panel">
                    <ul class="collection">
                        <li class="collection-item row">
                            <div class="col s2">
                                <b>State</b>
                            </div>
                            <div class="col s2">
                                <b>Case</b>
                            </div>
                            <div class="col s6">
                                <b>Task</b>
                            </div>
                            <div class="col 2">
                                <b>Time</b>
                            </div>
                        </li>
                        {{#each runningTimsheets}}
                            <a href="#!" class="black-text collection-item row">{{> runningTimesheetRow}}</a>
                        {{/each}}
                    </ul>
                </div>
            </div>
            <div class="col s12 m12 l6">
                <h5 class="teal white-text">Archived Timers</h5>
                <div class="card-panel">
                    <ul class="collection">

                    </ul>
                </div>
            </div>
        </div>
    </div>
    <a class="btn-floating btn-large teal" id="add-timesheets" href="/timesheets/add">
        <i class="large mdi-content-add"></i>
    </a>
</template>

<template name="timesheetRow">
    <tr class="row-clickable">
        <td>{{case}}</td>
        <td>{{totaltime}}</td>
        <!-- <td><a href="/projects/{{_id}}/timesheets">Details</a></td> -->
        <!-- <td><a href="/timesheets/{{_id}}/edit">Edit</a></td> -->
        <!-- <td> <button id='delete'>Delete</button></td> -->
    </tr>
</template>

<template name="editTimesheet">
    <!-- <h1>
		time from session : {{session_time}}
	</h1> -->
    {{> navigation }}
    <div class="container card-panel add-project">
        <h4 class="teal form-header">Edit a Timesheet</h4>

        <div class="row form-container">

            {{# autoForm id="insertTimesheetForm" class="col s12" doc=this type="method" meteormethod="saveTimesheetData" schema="timesheetSchema" }}

                <div class="row ">
                    <div class="input-field col s12">

                        {{> timetracker}}
                    </div>
                </div>
                <div class="row ">
                    <div class="input-field col s12">

                        <input type='text' name="duration" class="form-control" value="{{fetch_duration}}" id="duration"
                               data-schema-key="duration">
                    </div>
                </div>

                <div class="row input-field col s12">
                    {{> afFieldInput  type='xautocomplete' formid="insertTimesheetForm" name='caseId' call='cases' fieldref='name' reference='Projects' renderfunction='renderDefaultAutocomplete' id="meeting_case"}}
                    <label for="meeting_case" class="active">Matter</label>
                </div>

                <div class="row input-field col s12">
                    {{> afQuickField name='type' options='allowed' label=false}}
                    <label for="type" class="active">Type</label>
                </div>


                <button class="waves-effect waves-light btn" type="submit">Insert</button>
                <a class="waves-effect waves-teal btn-flat" href="/timesheets" style="position: absolute;">Cancel</a>
            {{/autoForm}}
        </div>
    </div>
</template>

<template name="timesheetDetail">
    <div class="row">
        {{> navigation}}
    </div>
    <div class="container">
        <div class="card-panel form-container">
            <div class="row">
                <!-- <a class="waves-effect waves-light btn" href = "/timesheets/add">Add Timesheet </a> -->
                <table class=" centered bordered	">
                    <thead>
                    <tr>
                        <th data-field="duration">Users</th>
                        <th data-field="desc">Time Spent</th>
                    </tr>
                    </thead>
                    <tbody>
                    {{#each timeloop}}
                        {{> timeDetailRow}}
                    {{/each}}
                    </tbody>
                </table>
            </div>
            <div class="row">
                <table class=" centered bordered	">
                    <thead>
                    <tr>
                        <th data-field="duration">Timesheets</th>
                        <th data-field="user">User</th>
                        <th data-field="desc">Duration</th>
                    </tr>
                    </thead>
                    <tbody>
                    {{#each timesheetloop}}
                        {{> timesheetDetailRow}}
                    {{/each}}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</template>

<template name="timeDetailRow">
    <tr>
        <td>{{user}}</td>
        <td>{{duration}}</td>
    </tr>
</template>


<template name="timesheetDetailRow">
    <tr>
        <td>{{type}}</td>
        <td>{{user}}</td>
        <td>{{duration}}</td>
        <td><a href="/timesheets/{{_id}}/edit">Edit</a></td>
    </tr>
</template>
